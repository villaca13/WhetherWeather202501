---
layout: mainLayout.njk
---


<script>


		document.addEventListener('DOMContentLoaded', () =>{ 
	    
		const urlParams = new URLSearchParams(window.location.search); 
	
		//* This is used to set the current city in local storage.
		if(urlParams.get('city') !== null) {
			localStorage.setItem("currentCity", urlParams.get('city'))
			//reset the current day to 0
			localStorage.setItem("currentDay", 0)
		}
		
		//* This is used to set the current city in local storage.
		if(urlParams.get('day') !== null) {
			localStorage.setItem("currentDay", urlParams.get('day'))
		}

		const cityDaily = weatherData[localStorage.getItem("currentCity").toLowerCase() + "_daily"]
	    const cityHourly = weatherData[localStorage.getItem("currentCity").toLowerCase() + "_hourly"]


		console.log(cityDaily)
    
	
		document.getElementById('page-heading').textContent= localStorage.getItem("currentCity").replace(/_/g, " "); 
		
		const sevenDays = document.querySelector("#sevenDays")
		// Populate Checkboxes with cities at preferences page

		for(let i = 0; i < 7; i++) {
			if(i == 0) {
				sevenDays.innerHTML =
					sevenDays.innerHTML + weatherProject.components.createWeatherItemDaily("Today", cityDaily , i )
			}else{
				sevenDays.innerHTML =
					sevenDays.innerHTML + weatherProject.components.createWeatherItemDaily(dayjs().add(i, 'day').format('ddd'), cityDaily , i )
			}

		}

		const now = dayjs();
		console.log(now)

		const currentHour = now.hour()
		console.log(currentHour)

		// Current Day Title
		const currentDay = document.querySelector("#currentDay")
		if(localStorage.getItem("currentDay") == 0) {
			currentDay.innerHTML = "Today"
		
		}else{
			currentDay.innerHTML = dayjs().add(localStorage.getItem("currentDay"), 'day').format('dddd')
		}



		// Min and Max Temp
		const minTemp = document.querySelector("#minTemp")
		minTemp.innerHTML = cityDaily.daily.temperature_2m_min[localStorage.getItem("currentDay")] + cityDaily.daily_units.temperature_2m_min
		const maxTemp = document.querySelector("#maxTemp")
		maxTemp.innerHTML = cityDaily.daily.temperature_2m_max[localStorage.getItem("currentDay")] + cityDaily.daily_units.temperature_2m_max

		// Max Wind
		const maxWind = document.querySelector("#maxWind")
		maxWind.innerHTML = cityDaily.daily.wind_speed_10m_max[localStorage.getItem("currentDay")] + cityDaily.daily_units.wind_speed_10m_max

		// Weather Condition
		const weatherCondition = document.querySelector("#weatherCondition")
		weatherCondition.src = "/images/" + cityDaily.daily.weather_code[localStorage.getItem("currentDay")] + ".png"

		// Map of the current city
		if(localStorage.getItem("Show_Map") === "true" ? true : false) {
			const mapPlace = document.querySelector("#headerMain")
			mapPlace.innerHTML = mapPlace.innerHTML + weatherProject.components.createMapPlace()

			const map = document.querySelector("#map")
			map.innerHTML = map.innerHTML + weatherProject.components.getMap(localStorage.getItem("currentCity"))
		}

		
		//table of the hourly weather
		if(localStorage.getItem("Show_12_hours_forecast") === "true" ? true : false){
			const rightNow = document.querySelector("#rightNow")
			rightNow.innerHTML = rightNow.innerHTML + weatherProject.components.createWeatherHourlyList(cityHourly, now.hour(), 12);
		}else{
			const rightNow = document.querySelector("#rightNow")
			rightNow.innerHTML = rightNow.innerHTML + weatherProject.components.createWeatherHourlyList(cityHourly, currentHour, 6);
		}
		
		});

</script>


<main id="index" class="box has-background-info ">
	<div class=" is-12 has-text-centered has-text-white">
		<p id="page-heading"  class="title is-1">  </p>
	</div>

	<header id="headerMain" class="columns has-text-centered">
		<div class="column"> 
			<section  class="card" >
				<header class="card-content">
					<h2 class="title is-centered">Right now</h2>
				</header>

				<div id="rightNow" class="card-content">				
				</div>

			</section>
		</div>


	</header>

	<div id="sevenDays" class="columns is-multiline box has-background-info is-centered">
		<div class="column is-12 has-text-centered has-text-white">
			<p class="title is-2">7 Days forecast</p>
		</div>
	</div>


	<footer class="columns is-multiline has-text-centered">
		<div class="column is-12 has-text-centered has-text-white">
			<p id= "currentDay" class="title is-2"></p>
		</div>

		<div class="column is-3"> 
			<section id="WeatherCondition" class="card" >
				<header class="card-content">
					<h2 class="title is-centered">Weather Codition</h2>
				</header>

				<div class="card-image ">
					<figure class="image is-48x48 is-inline-block">	
						<img id="weatherCondition"  src="#" alt="Image">
					</figure>
				</div>
			</section>
		</div>

		<div class="column is-3">
			<section  class="card" >

				<header class="card-content">
					<h2 class="title">Min Temp</h2>
				</header>

				<div class="card-content ">
					<p id="minTemp" class="title">6 C</p>
				</div>
				
			</section>
		</div>

		<div class="column is-3">
			<section  class="card" >
				<header class="card-content">
					<h2 class="title">Max Temp</h2>
				</header>

				<div class="card-content ">
					<p id="maxTemp" class="title">12 C</p>
				</div>
			</section>
		</div>

		<div class="column is-3">
			<section class="card" >
				<header class="card-content">
					<h2 class="title">Max Wind</h2>
				</header>

				<div class="card-content ">
					<p  id="maxWind" class="title">15 m/s </p>
				</div>
			</section>		
		</div>		
	</footer>
</main>

